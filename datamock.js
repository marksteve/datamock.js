// Generated by CoffeeScript 1.4.0
(function() {
  var attribSel, cache, emailDomains, emailNames, emailTLD, firstNames, genEmail, genName, lastNames, lorem, mock, mockChoice, mockChoices, mockValues, n, randChoice;

  firstNames = ["James", "John", "Robert", "Michael", "William", "David", "Richard", "Charles", "Joseph", "Thomas", "Mary", "Patricia", "Linda", "Barbara", "Elizabeth", "Jennifer", "Maria", "Susan", "Margaret", "Dorothy"];

  lastNames = ["Smith", "Johnson", "Williams", "Jones", "Brown", "Davis", "Miller", "Wilson", "Moore", "Taylor", "Anderson", "Thomas", "Jackson", "White", "Harris", "Martin", "Thompson", "Garcia", "Martinez", "Robinson"];

  emailNames = (function() {
    var _i, _len, _results;
    _results = [];
    for (_i = 0, _len = firstNames.length; _i < _len; _i++) {
      n = firstNames[_i];
      _results.push(n.toLowerCase());
    }
    return _results;
  })();

  emailDomains = (function() {
    var _i, _len, _results;
    _results = [];
    for (_i = 0, _len = lastNames.length; _i < _len; _i++) {
      n = lastNames[_i];
      _results.push(n.toLowerCase());
    }
    return _results;
  })();

  emailTLD = ["org", "com", "net"];

  lorem = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed vel velit et massa\nultricies viverra et eget nunc. Donec laoreet hendrerit sapien, eget rutrum\nlectus posuere vitae. Proin lobortis rhoncus enim, nec faucibus augue pharetra\nvel. Donec at nisi ligula, at gravida dui. Nulla sed sapien turpis, quis ornare\nnibh. Duis lacinia, leo non vehicula dapibus, nulla orci eleifend ligula, a\nmolestie sapien odio et nisi. Pellentesque vel ligula sem. Maecenas auctor\nconsectetur convallis.";

  randChoice = function(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
  };

  genName = function() {
    return "" + (randChoice(firstNames)) + " " + (randChoice(lastNames));
  };

  genEmail = function() {
    return "" + (randChoice(emailNames)) + "@" + (randChoice(emailDomains)) + "." + (randChoice(emailTLD));
  };

  attribSel = function($sel, attr) {
    attr = "[" + attr + "]";
    if ($sel.is(attr)) {
      $sel.add($sel.find(attr));
    } else {
      $sel = $sel.find(attr);
    }
    return $sel;
  };

  mockValues = function() {
    var $el, text;
    $el = $(this);
    switch ($el.data('mock')) {
      case 'id':
        text = $el.closest('[data-mock-id]').data('mock-id');
        break;
      case 'name':
        text = genName();
        break;
      case 'email':
        text = genEmail();
        break;
      case 'lorem':
        text = lorem;
    }
    switch (false) {
      case !$el.is('input[type=textbox]'):
        $el.val(text);
        break;
      default:
        $el.text(text);
    }
    return $el.removeAttr('data-mock');
  };

  mockChoices = function() {
    var $el;
    $el = $(this);
    $el.text(randChoice($el.data('mock-choices').split(',')));
    return $el.removeAttr('data-mock-choices');
  };

  mockChoice = function() {
    var $choice, $choices, $el, $siblings, choiceSel;
    $el = $(this);
    choiceSel = "[data-mock-choice='" + ($el.data('mock-choice')) + "']";
    $siblings = $el.siblings(choiceSel);
    if ($siblings.size() > 0) {
      $choices = $el.add($siblings);
      $choice = $(randChoice($choices.get()));
      $choice.siblings(choiceSel).remove();
      return $choice.removeAttr('data-mock-choice');
    }
  };

  mock = function($el) {
    attribSel($el, 'data-mock').each(mockValues);
    attribSel($el, 'data-mock-choices').each(mockChoices);
    return attribSel($el, 'data-mock-choice').show().each(mockChoice);
  };

  cache = {};

  $.fn.datamock = function() {
    return $(this).each(function() {
      var $clone, $pair, $parent, $template, $this, clone, cloneCount, i, _i, _j, _len, _ref, _results;
      $this = $(this);
      if (!cache[$this]) {
        cache[$this] = [];
        $(attribSel($this, 'data-mock-clone').get().reverse()).each(function() {
          var $el, $parent;
          $el = $(this);
          $parent = $el.parent();
          return cache[$this].push([$parent, $el.remove()]);
        });
      }
      mock($this);
      _ref = cache[$this];
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        $pair = _ref[_i];
        $parent = $pair[0];
        $template = $pair[1];
        clone = parseInt($template.data('mock-clone'), 10);
        cloneCount = $template.data('mock-clone-count') || 0;
        if (cloneCount >= clone && $template.data('mock-clone-fixed')) {
          continue;
        }
        for (i = _j = 1; 1 <= clone ? _j <= clone : _j >= clone; i = 1 <= clone ? ++_j : --_j) {
          $clone = $template.clone().removeAttr('data-mock-clone').attr('data-mock-id', cloneCount + i);
          $parent.append($clone);
          mock($clone);
        }
        cloneCount += clone;
        _results.push($template.data('mock-clone-count', cloneCount));
      }
      return _results;
    });
  };

}).call(this);
